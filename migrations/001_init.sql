CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE TABLE IF NOT EXISTS categories (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),parent_id UUID,name VARCHAR(255) NOT NULL,slug VARCHAR(255) UNIQUE,description TEXT,icon VARCHAR(10),image_url VARCHAR(500),product_count INTEGER DEFAULT 0,sort_order INTEGER DEFAULT 0,is_active BOOLEAN DEFAULT true,created_at TIMESTAMP DEFAULT NOW(),updated_at TIMESTAMP DEFAULT NOW());
CREATE TABLE IF NOT EXISTS vendors (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),company_name VARCHAR(255) NOT NULL,slug VARCHAR(255) UNIQUE,email VARCHAR(255),logo_url VARCHAR(500),rating DECIMAL(3,2) DEFAULT 0,review_count INTEGER DEFAULT 0,credit_balance DECIMAL(12,2) DEFAULT 0,is_active BOOLEAN DEFAULT true,created_at TIMESTAMP DEFAULT NOW(),updated_at TIMESTAMP DEFAULT NOW());
CREATE TABLE IF NOT EXISTS products (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),category_id UUID REFERENCES categories(id),title VARCHAR(500) NOT NULL,slug VARCHAR(500) UNIQUE,description TEXT,short_description TEXT,ean VARCHAR(50),sku VARCHAR(100),mpn VARCHAR(100),brand VARCHAR(255),image_url VARCHAR(500),price_min DECIMAL(12,2) DEFAULT 0,price_max DECIMAL(12,2) DEFAULT 0,offer_count INTEGER DEFAULT 0,stock_status VARCHAR(50) DEFAULT 'instock',is_active BOOLEAN DEFAULT true,is_featured BOOLEAN DEFAULT false,created_at TIMESTAMP DEFAULT NOW(),updated_at TIMESTAMP DEFAULT NOW());
CREATE TABLE IF NOT EXISTS offers (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),product_id UUID REFERENCES products(id),vendor_id UUID REFERENCES vendors(id),price DECIMAL(12,2) NOT NULL,url VARCHAR(1000),availability VARCHAR(50) DEFAULT 'instock',shipping_price DECIMAL(10,2) DEFAULT 0,is_active BOOLEAN DEFAULT true,created_at TIMESTAMP DEFAULT NOW());
INSERT INTO categories(name,slug,icon,sort_order) VALUES('Mobily','mobily','ðŸ“±',1),('Notebooky','notebooky','ðŸ’»',2),('TV','televizory','ðŸ“º',3) ON CONFLICT DO NOTHING;
